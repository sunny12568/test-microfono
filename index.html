<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mic Test - Check Your Microphone</title>
    <!-- Bootstrap 5 CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <style>
      :root {
        --primary: #4361ee;
        --secondary: #3a0ca3;
        --success: #4cc9f0;
        --danger: #f72585;
        --light: #f8f9fa;
        --dark: #212529;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        color: var(--light);
      }

      .card {
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        border: none;
        overflow: hidden;
      }

      .card-header {
        background: var(--primary);
        color: white;
        border-bottom: none;
        padding: 1.5rem;
      }

      .mic-icon {
        font-size: 3rem;
        color: var(--primary);
        margin-bottom: 1rem;
      }

      .volume-meter {
        height: 20px;
        background: #e9ecef;
        border-radius: 10px;
        overflow: hidden;
        margin: 1.5rem 0;
      }

      .volume-level {
        height: 100%;
        width: 0%;
        background: linear-gradient(90deg, #4cc9f0, #4361ee);
        border-radius: 10px;
        transition: width 0.1s ease;
      }

      .btn-primary {
        background: var(--primary);
        border: none;
        padding: 0.75rem 2rem;
        font-weight: 600;
      }

      .btn-primary:hover {
        background: var(--secondary);
      }

      .btn-outline-light {
        border: 2px solid var(--light);
        color: var(--light);
      }

      .btn-outline-light:hover {
        background: var(--light);
        color: var(--dark);
      }

      .status-indicator {
        display: inline-block;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        margin-right: 8px;
      }

      .status-active {
        background: var(--success);
        box-shadow: 0 0 10px var(--success);
      }

      .status-inactive {
        background: var(--danger);
      }

      .permission-alert {
        display: none;
      }

      .wave-animation {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100px;
        margin: 1rem 0;
      }

      .wave-bar {
        width: 8px;
        height: 40px;
        background: var(--success);
        margin: 0 3px;
        border-radius: 10px;
        animation: wave 1.2s infinite ease-in-out;
      }

      .wave-bar:nth-child(2) {
        animation-delay: 0.1s;
      }

      .wave-bar:nth-child(3) {
        animation-delay: 0.2s;
      }

      .wave-bar:nth-child(4) {
        animation-delay: 0.3s;
      }

      .wave-bar:nth-child(5) {
        animation-delay: 0.4s;
      }

      @keyframes wave {
        0%,
        40%,
        100% {
          transform: scaleY(0.5);
        }
        20% {
          transform: scaleY(1.5);
        }
      }

      footer {
        margin-top: 2rem;
        font-size: 0.9rem;
        opacity: 0.8;
      }

      .feature-card {
        transition: transform 0.3s ease;
        height: 100%;
      }

      .feature-card:hover {
        transform: translateY(-5px);
      }

      .info-section {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 15px;
        padding: 2rem;
        margin-top: 2rem;
      }
    </style>
  </head>
  <body>
    <div class="container py-5">
      <div class="row justify-content-center">
        <div class="col-md-10 col-lg-8">
          <div class="card bg-dark text-white">
            <div class="card-header text-center">
              <h1 class="h3 mb-0">
                <i class="fas fa-microphone me-2"></i>Microphone Test
              </h1>
            </div>
            <div class="card-body p-4">
              <div class="text-center mb-4">
                <div class="mic-icon">
                  <i class="fas fa-microphone"></i>
                </div>
                <h2>Test Your Microphone</h2>
                <p class="text-muted">
                  Check if your microphone is working properly before important
                  calls, recordings, or streaming sessions.
                </p>
              </div>

              <div class="alert alert-warning permission-alert" role="alert">
                <i class="fas fa-exclamation-triangle me-2"></i>
                Please allow microphone access to test your device.
              </div>

              <div class="mb-4">
                <div class="d-flex justify-content-between mb-2">
                  <span>Microphone Status:</span>
                  <span id="statusText" class="fw-bold">Not Connected</span>
                </div>
                <div class="volume-meter">
                  <div class="volume-level" id="volumeLevel"></div>
                </div>
                <div class="d-flex justify-content-between">
                  <small>Quiet</small>
                  <small>Loud</small>
                </div>
              </div>

              <div
                class="wave-animation"
                id="waveAnimation"
                style="display: none"
              >
                <div class="wave-bar"></div>
                <div class="wave-bar"></div>
                <div class="wave-bar"></div>
                <div class="wave-bar"></div>
                <div class="wave-bar"></div>
              </div>

              <div class="text-center mb-4">
                <p id="instructionText" class="mb-3">
                  Click the button below to start testing your microphone. Speak
                  normally and watch the volume meter respond to your voice.
                </p>
                <button class="btn btn-primary btn-lg" id="testButton">
                  <i class="fas fa-play me-2"></i>Start Test
                </button>
                <button
                  class="btn btn-outline-light ms-2"
                  id="stopButton"
                  style="display: none"
                >
                  <i class="fas fa-stop me-2"></i>Stop Test
                </button>
              </div>

              <div class="info-section">
                <h3 class="h4 mb-3">Why Test Your Microphone?</h3>
                <p>
                  Testing your microphone ensures that you'll have clear audio
                  quality for:
                </p>
                <ul>
                  <li>
                    <strong>Video conferences</strong> - Be heard clearly in
                    work meetings
                  </li>
                  <li>
                    <strong>Online gaming</strong> - Communicate effectively
                    with your team
                  </li>
                  <li>
                    <strong>Podcasting & streaming</strong> - Deliver
                    professional audio to your audience
                  </li>
                  <li>
                    <strong>Voice recordings</strong> - Create high-quality
                    content
                  </li>
                  <li>
                    <strong>Voice commands</strong> - Ensure voice assistants
                    can understand you
                  </li>
                </ul>

                <div class="row mt-4">
                  <div class="col-md-6 mb-3">
                    <div class="card feature-card bg-secondary text-white">
                      <div class="card-body text-center">
                        <i class="fas fa-headset fa-2x mb-3"></i>
                        <h5>Headset Microphones</h5>
                        <p class="small">
                          Perfect for gaming and calls where you need hands-free
                          operation
                        </p>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6 mb-3">
                    <div class="card feature-card bg-secondary text-white">
                      <div class="card-body text-center">
                        <i class="fas fa-desktop fa-2x mb-3"></i>
                        <h5>Built-in Microphones</h5>
                        <p class="small">
                          Test the microphone in your laptop, tablet, or
                          smartphone
                        </p>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="mt-4">
                  <h5 class="mb-3">Tips for Better Audio Quality:</h5>
                  <ul class="list-unstyled">
                    <li>
                      <i class="fas fa-check-circle text-success me-2"></i
                      >Ensure your microphone is properly connected
                    </li>
                    <li>
                      <i class="fas fa-check-circle text-success me-2"></i>Speak
                      clearly and at a consistent volume
                    </li>
                    <li>
                      <i class="fas fa-check-circle text-success me-2"></i
                      >Reduce background noise for better results
                    </li>
                    <li>
                      <i class="fas fa-check-circle text-success me-2"></i>Check
                      your browser's microphone permissions
                    </li>
                    <li>
                      <i class="fas fa-check-circle text-success me-2"></i
                      >Position the microphone 6-12 inches from your mouth
                    </li>
                  </ul>
                </div>

                <div class="mt-4 text-center">
                  <p>
                    For more advanced microphone testing and troubleshooting,
                    visit:
                  </p>
                  <div class="d-flex justify-content-center gap-3 flex-wrap">
                    <a
                      href="https://microphone-test.com/"
                      class="btn btn-outline-light"
                      target="_blank"
                    >
                      <i class="fas fa-external-link-alt me-2"></i
                      >Microphone-Test.com
                    </a>
                    <a
                      href="https://microphone-test.com/why-microphone-not-working/"
                      class="btn btn-outline-light"
                      target="_blank"
                    >
                      <i class="fas fa-tools me-2"></i>Troubleshooting Guide
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <footer class="text-center mt-4">
            <p>
              Mic Test Tool &copy; 2023 | Works in Chrome, Firefox, Edge, and
              Safari
            </p>
          </footer>
        </div>
      </div>
    </div>

    <!-- Bootstrap 5 JS with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const testButton = document.getElementById("testButton");
        const stopButton = document.getElementById("stopButton");
        const volumeLevel = document.getElementById("volumeLevel");
        const statusText = document.getElementById("statusText");
        const instructionText = document.getElementById("instructionText");
        const waveAnimation = document.getElementById("waveAnimation");
        const permissionAlert = document.querySelector(".permission-alert");

        let audioContext;
        let analyser;
        let microphone;
        let javascriptNode;
        let isTesting = false;

        // Function to start the microphone test
        async function startTest() {
          try {
            // Request microphone access
            const stream = await navigator.mediaDevices.getUserMedia({
              audio: true,
              video: false,
            });

            // Hide permission alert if shown
            permissionAlert.style.display = "none";

            // Set up audio context and analyser
            audioContext = new (window.AudioContext ||
              window.webkitAudioContext)();
            analyser = audioContext.createAnalyser();
            microphone = audioContext.createMediaStreamSource(stream);

            // Connect microphone to analyser
            microphone.connect(analyser);

            // Set up analyser properties
            analyser.fftSize = 256;
            const bufferLength = analyser.frequencyBinCount;
            const dataArray = new Uint8Array(bufferLength);

            // Create script processor for audio analysis
            javascriptNode = audioContext.createScriptProcessor(2048, 1, 1);

            // Connect analyser to script processor and destination
            analyser.connect(javascriptNode);
            javascriptNode.connect(audioContext.destination);

            // Process audio data
            javascriptNode.onaudioprocess = function () {
              // Get the frequency data
              analyser.getByteFrequencyData(dataArray);

              // Calculate average volume
              let values = 0;
              for (let i = 0; i < dataArray.length; i++) {
                values += dataArray[i];
              }

              const average = values / dataArray.length;

              // Update volume meter (scale to 0-100%)
              const volumePercent = Math.min(
                100,
                Math.max(0, (average * 100) / 128)
              );
              volumeLevel.style.width = volumePercent + "%";

              // Change color based on volume
              if (volumePercent < 30) {
                volumeLevel.style.background = "#4cc9f0";
              } else if (volumePercent < 70) {
                volumeLevel.style.background = "#4361ee";
              } else {
                volumeLevel.style.background = "#f72585";
              }
            };

            // Update UI
            statusText.innerHTML =
              '<span class="status-indicator status-active"></span>Connected & Listening';
            statusText.className = "fw-bold text-success";
            instructionText.textContent =
              "Speak into your microphone to test it. The volume meter should respond to your voice. Try speaking at different volumes to see the meter change.";
            testButton.style.display = "none";
            stopButton.style.display = "inline-block";
            waveAnimation.style.display = "flex";
            isTesting = true;
          } catch (error) {
            console.error("Error accessing microphone:", error);
            permissionAlert.style.display = "block";
            statusText.innerHTML =
              '<span class="status-indicator status-inactive"></span>Access Denied';
            statusText.className = "fw-bold text-danger";
            instructionText.textContent =
              "Please allow microphone access and try again. Check your browser permissions and make sure no other application is using your microphone.";
          }
        }

        // Function to stop the microphone test
        function stopTest() {
          if (javascriptNode) {
            javascriptNode.disconnect();
          }
          if (microphone) {
            microphone.disconnect();
          }
          if (audioContext) {
            audioContext.close();
          }

          // Reset UI
          volumeLevel.style.width = "0%";
          statusText.innerHTML =
            '<span class="status-indicator status-inactive"></span>Not Connected';
          statusText.className = "fw-bold text-danger";
          instructionText.textContent =
            "Click the button below to start testing your microphone. Speak normally and watch the volume meter respond to your voice.";
          testButton.style.display = "inline-block";
          stopButton.style.display = "none";
          waveAnimation.style.display = "none";
          isTesting = false;
        }

        // Event listeners for buttons
        testButton.addEventListener("click", startTest);
        stopButton.addEventListener("click", stopTest);

        // Check if browser supports getUserMedia
        if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
          permissionAlert.innerHTML =
            '<i class="fas fa-exclamation-triangle me-2"></i>Your browser does not support microphone access. Please try Chrome, Firefox, Edge, or Safari.';
          permissionAlert.style.display = "block";
          testButton.disabled = true;
        }
      });
    </script>
  </body>
</html>

